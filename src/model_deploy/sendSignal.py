import numpy as np

import serial

import time


waitTime = 0.2


song1 = [0.261, 0.261, 0.392, 0.392, 0.440, 0.440, 0.392,
         0.349, 0.349, 0.330, 0.330, 0.294, 0.294, 0.261,
         0.392, 0.392, 0.349, 0.349, 0.330, 0.330, 0.294,
         0.392, 0.392, 0.349, 0.349, 0.330, 0.330, 0.294,
         0.261, 0.261, 0.392, 0.392, 0.440, 0.440, 0.392,
         0.349, 0.349, 0.330, 0.330, 0.294, 0.294, 0.261]

length1 = [0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.2,
           0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.2,
           0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.2,
           0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.2,
           0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.2,
           0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.2]

song2 = [0.392, 0.330, 0.330, 0.349, 0.294, 0.294,
         0.262, 0.294, 0.330, 0.349, 0.392, 0.392, 0.392,
         0.392, 0.330, 0.330, 0.349, 0.294, 0.294,
         0.262, 0.330, 0.392, 0.392, 0.262]

length2 = [0.1, 0.1, 0.2, 0.1, 0.1, 0.2,
           0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.2,
           0.1, 0.1, 0.2, 0.1, 0.1, 0.2,
           0.1, 0.1, 0.1, 0.1, 0.4]

song3 = [0.262, 0.294, 0.330, 0.262, 0.262, 0.294, 0.330, 0.262,
         0.330, 0.349, 0.392, 0.330, 0.349, 0.392,
         0.392, 0.440, 0.392, 0.349, 0.330, 0.262,
         0.392, 0.440, 0.392, 0.349, 0.330, 0.262,
         0.262, 0.196, 0.262, 0.262, 0.196, 0.262]

length3 = [0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2,
           0.2, 0.2, 0.4, 0.2, 0.2, 0.4,
           0.1, 0.1, 0.1, 0.1, 0.2, 0.2,
           0.1, 0.1, 0.1, 0.1, 0.2, 0.2,
           0.2, 0.2, 0.4, 0.2, 0.2, 0.4]

signalLength = 42*2 + 24*2 + 32*2

signalTable = song1 + length1 + song2 + length2 + song3 + length3


# output formatter

formatter = lambda x: "%.3f" % x


# send the waveform table to K66F

serdev = '/dev/ttyACM0'

s = serial.Serial(serdev)

print("Sending signal ...")

print("It may take about %d seconds ..." % (int(signalLength * waitTime)))

for data in signalTable:

  s.write(bytes(formatter(data), 'UTF-8'))

  time.sleep(waitTime)

s.close()

print("Signal sended")